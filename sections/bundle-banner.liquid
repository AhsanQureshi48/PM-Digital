{{ 'section-bundle-banner.css' | asset_url | stylesheet_tag }}

{%- style -%}
  /* Mobile-first padding: base = mobile, then desktop override */
  .section-{{ section.id }}-padding .bundle-banner__inner {
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding .bundle-banner__inner {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  #{{ section_id }} {
    --bundle-banner-bg: {{ section.settings.background_color }};
    --bundle-banner-text: {{ section.settings.text_color }};
    --bundle-banner-accent: {{ section.settings.accent_color }};
  }
{%- endstyle -%}

{%- liquid
  assign heading = section.settings.heading | default: ''
  assign heading_highlight = section.settings.heading_highlight | default: ''
  assign subheading = section.settings.subheading | default: ''
  assign cta_label = section.settings.cta_label | default: ''
  assign cta_link = section.settings.cta_link | default: ''
  assign background_image = section.settings.background_image
  assign product_image = section.settings.product_image
  assign product_image_mobile = section.settings.product_image_mobile
  assign section_id = 'BundleBanner-' | append: section.id
-%}

<section
  id="{{ section_id }}"
  class="bundle-banner section-{{ section.id }}-padding"
  aria-labelledby="{{ section_id }}-heading"
>
  <div class="bundle-banner__inner">
    {%- if background_image != blank -%}
      <div class="bundle-banner__bg" aria-hidden="true">
        {{
          background_image
          | image_url: width: 1920
          | image_tag: loading: 'lazy', widths: '390, 750, 1100, 1440, 1920', sizes: '100vw', alt: ''
        }}
      </div>
    {%- endif -%}

    <div class="bundle-banner__content">
      {%- comment -%} Mobile-first: image first on small screens; desktop order via CSS. {%- endcomment -%}
      <div class="bundle-banner__media">
        {%- if product_image != blank and product_image_mobile != blank -%}
          {%- liquid
            assign desktop_srcset_550 = product_image | image_url: width: 550
            assign desktop_srcset_750 = product_image | image_url: width: 750
            assign desktop_srcset_800 = product_image | image_url: width: 800
          -%}
          <picture>
            {%- comment -%} Mobile-first: default is mobile img below; source enhances for desktop (min-width). {%- endcomment -%}
            <source
              media="(min-width: 750px)"
              srcset="{{ desktop_srcset_550 }} 550w, {{ desktop_srcset_750 }} 750w, {{ desktop_srcset_800 }} 800w"
              sizes="(min-width: 750px) 50vw, 100vw"
            >
            {{
              product_image_mobile
              | image_url: width: 800
              | image_tag:
                loading: 'lazy',
                widths: '390, 550, 750, 800',
                sizes: '100vw',
                alt: product_image_mobile.alt | default: 'Bundle product image'
            }}
          </picture>
        {%- elsif product_image != blank -%}
          {{
            product_image
            | image_url: width: 800
            | image_tag:
              loading: 'lazy',
              widths: '390, 550, 750, 800',
              sizes: '(min-width: 750px) 50vw, 100vw',
              alt: product_image.alt | default: 'Bundle product image'
          }}
        {%- elsif product_image_mobile != blank -%}
          {{
            product_image_mobile
            | image_url: width: 800
            | image_tag:
              loading: 'lazy',
              widths: '390, 550, 750, 800',
              sizes: '(min-width: 750px) 50vw, 100vw',
              alt: product_image_mobile.alt | default: 'Bundle product image'
          }}
        {%- else -%}
          <div class="bundle-banner__placeholder" aria-hidden="true">
            {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
          </div>
        {%- endif -%}
      </div>

      <div class="bundle-banner__text">
        {%- if heading != blank or heading_highlight != blank -%}
          <h2 id="{{ section_id }}-heading" class="bundle-banner__heading">
            {%- if heading != blank -%}{{ heading }}{%- endif -%}
            {%- if heading_highlight != blank -%}
              {%- if heading != blank -%} {%- endif -%}<span class="bundle-banner__heading-highlight">{{ heading_highlight }}</span>
            {%- endif -%}
          </h2>
        {%- endif -%}
        {%- if subheading != blank -%}
          <p class="bundle-banner__subheading">{{ subheading }}</p>
        {%- endif -%}
        {%- if cta_label != blank -%}
          <a
            href="{% if cta_link != blank %}{{ cta_link }}{% else %}#{% endif %}"
            class="bundle-banner__cta"
            {% if cta_link == blank %}
              aria-disabled="true"
            {% endif %}
          >
            {{ cta_label | escape }}
          </a>
        {%- endif -%}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Bundle Banner",
  "tag": "section",
  "class": "section bundle-banner-section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Smart stack, smarter price - shop curated bundles and"
    },
    {
      "type": "text",
      "id": "heading_highlight",
      "label": "Heading highlight (accent color)",
      "default": "save 30%.",
      "info": "Shown in accent color after the main heading."
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Clinically informed formulas that support energy, balance, and everyday wellness."
    },
    {
      "type": "text",
      "id": "cta_label",
      "label": "CTA button label",
      "default": "Shop Bundles"
    },
    {
      "type": "url",
      "id": "cta_link",
      "label": "CTA link",
      "info": "Collection or any custom URL."
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image",
      "info": "Optional. Dark teal gradient used if empty."
    },
    {
      "type": "image_picker",
      "id": "product_image",
      "label": "Product / bundle image (desktop)",
      "info": "e.g. three bottles or bundle asset. Used on desktop and as fallback."
    },
    {
      "type": "image_picker",
      "id": "product_image_mobile",
      "label": "Product / bundle image (mobile)",
      "info": "Optional. Shown on screens under 750px. Falls back to desktop image if blank."
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#1a3d4a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color (highlight & CTA)",
      "default": "#5eb8c9"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Top padding (mobile)",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Bottom padding (mobile)",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Bundle Banner"
    }
  ]
}
{% endschema %}
